library(devtools)
use_package("GenomicRanges")
use_r("Used_fn")
devtools::load_all(".")
to_make_gr_object_chr_base_loc()
to_make_gr_object_chr_base_loc(chr_base_loc_vec = c("chr2:150-151"),column_name = "Peak_id")
?GRanges
devtools::load_all(".")
to_make_gr_object_chr_base_loc(chr_base_loc_vec = c("chr2:150-151"),column_name = "Peak_id")
devtools::load_all(".")
to_make_gr_object_chr_base_loc(chr_base_loc_vec = c("chr2:150-151"),column_name = "Peak_id")
?to_make_gr_object_chr_base_loc
devtools::load_all(".")
to_make_gr_object_chr_base_loc()
?to_make_gr_object_chr_base_loc()
devtools::load_all(".")
?to_make_gr_object_chr_base_loc
library(Usefn)
example(to_make_gr_object_chr_base_loc,package = "GenomicRanges")
?to_make_gr_object_chr_base_loc
library(Usefn)
example(to_make_gr_object_chr_base_loc,package = "Usefn")
devtools::load_all(".")
library(Usefn)
?unique_grobject_metacol
unique_grobject_metacol()
devtools::load_all(".")
unique_grobject_metacol(genomic_coord = c("chr2:15000-15500"),metacolumn_name = "Peak_id")
?unique_grobject_metacol
devtools::load_all(".")
?unique_grobject_metacol
library(Usefn)
example(unique_grobject_metacol,package = "Usefn")
devtools::load_all(".")
library(Usefn)
example(unique_grobject_metacol,package = "Usefn")
?unique_grobject_metacol
devtools::load_all(".")
?to_overlap_grange_object
to_overlap_grange_object
devtools::load_all(".")
to_get_overlap_bw_gr_from_peakids()
?to_get_overlap_bw_gr_from_peakids
devtools::load_all(".")
?to_overlap_grange_object
?to_find_nearest_dist_grange_object
?to_get_overlap_bw_gr_from_peakids
?to_get_bed_df_peaks_from_peak_id_vector
to_overlap_grange_object()
to_overlap_grange_object
to_find_nearest_dist_grange_object
to_get_overlap_bw_gr_from_peakids
to_get_bed_df_peaks_from_peak_id_vector
devtools::load_all(".")
library(Usefn)
unique_grobject_metacol
to_overlap_grange_object
to_find_nearest_dist_grange_object
modify_string
devtools::load_all(".")
modify_string
modify_string(x = "a_b",delimtter = "_",position = 1)
to_get_bed_df_peaks_from_peak_id_vector(input_peak_id_vector = c("chr2:111-112"))
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:115-120"),input1_colname = "Q1",input2_colname = "Q2)
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:115-120"),input1_colname = "Q1",input2_colname = "Q2")
devtools::load_all(".")
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:115-120"),input1_colname = "Q1",input2_colname = "Q2")
devtools::load_all(".")
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:115-120"),input1_colname = "Q1",input2_colname = "Q2")
devtools::load_all(".")
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:115-120"),input1_colname = "Q1",input2_colname = "Q2")
unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1")
to_overlap_grange_object(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"),gr1_col = "Q1",gr2_col = "Q2")
?queryHits
GenomicRanges::queryHits
devtools::load_all(".")
to_overlap_grange_object(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"),gr1_col = "Q1",gr2_col = "Q2")
??queryHits
a = findOverlaps(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"))
a = GenomicRanges::findOverlaps(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"))
GenomicRanges::findOverlaps(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"))
devtools::load_all(".")
library(Usefn)
library(Usefn)
GenomicRanges::findOverlaps(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"))
?findOverlaps
IRanges::findOverlaps
IRanges::queryHits
IRanges::elementMetadata
GenomicRanges::elementMetadata
pintersect
width
devtools::load_all(".")
IRanges::findOverlaps(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"))
devtools::load_all(".")
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:110-255"),input1_colname = "Q1",input2_colname = "Q2")
255-110
to_overlap_grange_object(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"),gr1_col = "Q1",gr2_col = "Q2")
devtools::load_all(".")
to_overlap_grange_object(gr1 = unique_grobject_metacol(genomic_coord = c("ch2:110-300"),metacolumn_name = "Q1"),gr2 = unique_grobject_metacol(genomic_coord = c("ch2:110-255"),metacolumn_name = "Q2"),gr1_col = "Q1",gr2_col = "Q2")
to_get_overlap_bw_gr_from_peakids(input_genomic_coord1 = c("ch2:110-300"),input_genomic_coord2 = c("ch2:110-255"),input1_colname = "Q1",input2_colname = "Q2")
Iranges::distanceToNearest
IRanges::distanceToNearest
devtools::load_all(".")
to_get_bed_df_peaks_from_peak_id_vector(input_peak_id_vector = c("ch2:111-112"))
devtools::load_all(".")
?fisher.test
?getBM
?rowVars
??rowVars
devtools::load_all(".")
library(Usefn)
compute_pca
library(Usefn)
usethis::use_package(package = c("matrixStats","GenomicRanges","pheatmap"),type = "Imports")
usethis::use_package(package = "matrixStats",type = "Imports")
usethis::use_package(package = "pheatmap",type = "Imports")
usethis::use_package(package = "matrixStats",type = "Depends")
usethis::use_package(package = "DESeq2",type = "Depends")
devtools::load_all(".")
library(Usefn)
usethis::use_github()
library(Usefn)
load("/Users/daga/Documents/Projects/Autoimmune/JIA/dds_rld_objects/JIA_SFvsPBMC_ovelap2_with_nosummit_no_sex_stdchr.rda")
## JIA 26730 peaks
count_matrix =  assay(rld)
meta_df =  as.data.frame(colData(rld))
View(meta_df)
meta_df$Tissue = factor(meta_df$Tissue,levels = c("SF", "PB"))
all(colnames(count_matrix) == rownames(meta_df))
data_orginal = assay(rld)
cleaned_data <- removeBatchEffect(data_orginal,
batch = meta_df$Batch,
design =  model.matrix( ~ meta_df$Tissue))
library(limma)
compute_pca
compute_pca(data_mat = count_matrix,ntop = 1000,meta_df = meta_df)
library(Usefn)
load("/Users/daga/Documents/Projects/Autoimmune/JIA/dds_rld_objects/JIA_SFvsPBMC_ovelap2_with_nosummit_no_sex_stdchr.rda")
count_matrix =  assay(rld)
meta_df =  as.data.frame(colData(rld))
meta_df$Tissue = factor(meta_df$Tissue,levels = c("SF", "PB"))
all(colnames(count_matrix) == rownames(meta_df))
compute_pca(data_mat = count_matrix,ntop = 1000,meta_df = meta_df)
View(meta_df)
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = "~/Deskop_test.pdf",logTransform = TRUE)
devtools::load_all(".")
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = "~/Deskop_test.pdf",logTransform = TRUE)
devtools::load_all(".")
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = "~/Deskop_test.pdf",logTransform = TRUE)
devtools::load_all(".")
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = "~/Deskop_test.pdf",logTransform = TRUE)
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = /Deskop_test.pdf",logTransform = TRUE)
pca.correlogram(count_matrix = count_matrix,ntop = 1000,metadata = meta_df,covs = c("Tissue","Batch"),scale = TRUE,pcCount = 3,outdir = "~/Desktop/test.pdf",logTransform = TRUE)
draw_heatmap_top_peaks(data_mat = count_matrix,ntop = 1000,col_select = c("Tissue","Batch"),meta_df = meta_df,outfn = "~/Desktop/test.pdf",rownorm = FALSE)
load("/Users/daga/Documents/Projects/Autoimmune/JIA/RNA_seq/Process_with_merge/DE_result/JIA.SF_untreated_vs_HC.PBMC_untreated_de_result.RData")
maplot(res = res)
head(as.data.frame(res))
res$baseMean
plot(res$baseMean, res$log2FoldChange)
plot(res$baseMean, res$log2FoldChange,log="x")
? with
devtools::load_all(".")
maplot(res = res,thresh = 0.05)
devtools::load_all(".")
maplot(res = res,thresh = 0.05)
maplot(res = res,thresh = 0.05,labelsig = FALSE)
volcanoplot(res = res)
devtools::load_all(".")
volcanoplot(res = res)
head(res)
to_add_gene_symbol_ENSEMBL(input_ensembl_vector = c("ENSG00000279457"))
library(Usefn)
usethis::use_readme_md()
``` r
``` r
``` r
```
